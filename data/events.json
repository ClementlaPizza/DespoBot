[null,{"name":"<center>API","temp":"","event-type":"0","_id":"vzoJc","actions":[]},{"name":"Twitch Auth","temp":"","event-type":"1","_id":"hONNV","actions":[{"filename":"resources/Twitch/Token/id.txt","storage":"3","varName2":"twitch_id","name":"Read File"},{"filename":"resources/Twitch/Token/secret.txt","storage":"1","varName2":"twitch_secret","name":"Read File"},{"client_id":"${globalVars(\"twitch_id\")}","client_secret":"${tempVars(\"twitch_secret\")}","info":"0","storage":"3","varName":"twitch_auth","debug":"true","name":"Twitch Authentication"}]},{"name":"<center>Bot","temp":"300","event-type":"0","_id":"ZXvSn","actions":[]},{"name":"status","temp":"300","event-type":"1","_id":"ITzgh","actions":[{"comment":"Initialisation","color":"#00ff00","name":"Comment"},{"time":"5","measurement":"1","name":"Wait"},{"comment":"Despo en live","color":"#00ff00","name":"Comment"},{"type":"1","inputtype":"1","input":"desp0tikgirl","info1":"2","info2":"5","info3":"3","info4":"0","clientid":"${globalVars(\"twitch_id\")}","token":"${globalVars(\"twitch_auth\")}","results":"","storage":"1","varName":"despoenlive","cache":"true","name":"Store Twitch Info"},{"type":"1","inputtype":"1","input":"desp0tikgirl","info1":"2","info2":"12","info3":"3","info4":"0","clientid":"${globalVars(\"twitch_id\")}","token":"${globalVars(\"twitch_auth\")}","results":"","storage":"1","varName":"despogame","cache":"true","name":"Store Twitch Info"},{"storage":"1","varName":"despoenlive","comparison":"0","value":"true","iftrue":"0","iftrueVal":"","iffalse":"2","iffalseVal":"10","name":"Check Variable"},{"activity":"3","nameText":"Despo est en live sur ${tempVars(\"despogame\")}","url":"https://www.twitch.tv/desp0tikgirl","stat":"0","name":"Set Bot Activity"},{"time":"10","measurement":"2","name":"Wait"},{"call":"1","name":"Jump to Action"},{"comment":"Despo hors live","color":"#00ff00","name":"Comment"},{"comment":"--- Bonjour","color":"#00ff00","name":"Comment"},{"activity":"0","nameText":"Bien le bonjour ðŸ˜„","url":"","stat":"0","name":"Set Bot Activity"},{"time":"5","measurement":"2","name":"Wait"},{"comment":"--- Nombre de membre","color":"#00ff00","name":"Comment"},{"server":"0","varName":"","info":"17","storage":"1","varName2":"member_count","name":"Store Server Info"},{"activity":"2","nameText":"${tempVars(\"member_count\")} membres dans la DespotikFamily.","url":"","stat":"0","name":"Set Bot Activity"},{"time":"5","measurement":"2","name":"Wait"},{"comment":"Reset","color":"#00ff00","name":"Comment"},{"call":"1","name":"Jump to Action"}]},{"name":"<center>La Porte","temp":"300","event-type":"0","_id":"ZTxcx","actions":[]},{"name":"Nouveau membre","temp":"member","event-type":"6","_id":"uMDNY","actions":[{"comment":"Variables","color":"#00ff00","name":"Comment"},{"info":"0","find":"776073773874413639","storage":"1","varName":"channelid","name":"Find Channel"},{"member":"2","varName":"member","info":"0","storage":"1","varName2":"member_object","name":"Store Member Info"},{"member":"2","varName":"member","info":"2","storage":"1","varName2":"member_username","name":"Store Member Info"},{"member":"2","varName":"member","info":"16","storage":"1","varName2":"member_avatar","name":"Store Member Info"},{"server":"0","varName":"","info":"35","storage":"1","varName2":"member_count","name":"Store Server Info"},{"color":"#00ff00","storage":"1","varName":"color","name":"Color"},{"comment":"Message","color":"#00ff00","name":"Comment"},{"title":"viens de rejoindre la DespotikFamily","author":"${tempVars(\"member_username\")}","color":"${tempVars(\"color\")}","url":"","authorIcon":"${tempVars(\"member_avatar\")}","authorUrl":"","imageUrl":"${tempVars(\"member_avatar\")}","thumbUrl":"","timestamp":"string","debug":"false","text":"${tempVars(\"member_count\")} membres","year":"","month":"","day":"","hour":"","minute":"","second":"","storage":"1","varName":"embed","name":"Create Embed Message"},{"storage":"1","varName":"embed","fieldName":"","message":"Bienvenue sur le serveur ${tempVars(\"member_object\")}","inline":"1","name":"Add Embed Field"},{"storage":"1","varName":"embed","channel":"5","varName2":"channelid","storage3":"0","varName3":"","iffalse":"0","iffalseVal":"","messageContent":"","name":"Send Embed Message"}]},{"name":"Depart d'un membre","temp":"member","event-type":"7","_id":"Hisxu","actions":[{"comment":"Variables","color":"#00ff00","name":"Comment"},{"info":"0","find":"734814575064514611","storage":"1","varName":"channelid","name":"Find Channel"},{"member":"2","varName":"member","info":"0","storage":"1","varName2":"member_object","name":"Store Member Info"},{"member":"2","varName":"member","info":"2","storage":"1","varName2":"member_username","name":"Store Member Info"},{"member":"2","varName":"member","info":"16","storage":"1","varName2":"member_avatar","name":"Store Member Info"},{"color":"#ff0000","storage":"1","varName":"color","name":"Color"},{"server":"0","varName":"","info":"35","storage":"1","varName2":"member_count","name":"Store Server Info"},{"comment":"Message","color":"#00ff00","name":"Comment"},{"title":"viens de quitter la DespotikFamily","author":"${tempVars(\"member_username\")}","color":"${tempVars(\"color\")}","url":"","authorIcon":"${tempVars(\"member_avatar\")}","authorUrl":"","imageUrl":"","thumbUrl":"","timestamp":"string","debug":"false","text":"${tempVars(\"member_count\")} membres","year":"","month":"","day":"","hour":"","minute":"","second":"","storage":"1","varName":"embed","name":"Create Embed Message"},{"storage":"1","varName":"embed","fieldName":"","message":"${tempVars(\"member_object\")} Ã  quitter le serveur ","inline":"1","name":"Add Embed Field"},{"storage":"1","varName":"embed","channel":"5","varName2":"channelid","storage3":"0","varName3":"","iffalse":"0","iffalseVal":"","messageContent":"","name":"Send Embed Message"}]},{"name":"reactionStart","temp":"","event-type":"1","_id":"Lwriz","actions":[{"behavior":"0","interpretation":"1","code":"if (globalVars(\"RoleReactionMenuAlreadyRan\") == null) {\n    const Discord = require(\"discord.js\");\n    const path = require(\"path\");\n    Actions.storeValue(true, 3, \"RoleReactionMenuAlreadyRan\", cache);\n\n    if(globalVars(\"installedStenoRequest\") == null) {\n        Actions.storeValue(true, 3, \"installedStenoRequest\", cache);\n\n        try {\n            require.resolve(\"request\");\n            require.resolve(\"graceful-fs\");\n            require.resolve(\"steno\");\n        } catch(e) {\n            console.log(\"Required NPM modules not found!\\n\\nInstalling modules..\");\n            var child_process = require('child_process');\n            child_process.execSync('npm install steno request graceful-fs',{stdio:\"pipe\"});\n            console.log(\"NPM Module Installation Complete\")\n        }\n        console.log(\"NPM Module Check Complete\\n\")\n    }\n\n    const request = require('request');\n    const fs = require('graceful-fs');\n    const steno = require('steno')\n\n    //Settings\n    const dmUserAfter = true; // Default: true, can be changed to false\n    var messageSentAdd = 'Successfully added the role {rolename} in {server}';\n    var messageSentRemove = 'Successfully removed the role {rolename} in {server}';\n    var debug = false; // Default: false, can be changed to true\n    var checkUpdates = true;\n    // The only variables that work rn, {rolename} and {server}\n\n    var requiredIntents = [\"GUILDS\",\"GUILD_MEMBERS\",\"GUILD_MESSAGE_REACTIONS\",\"GUILD_MESSAGES\"];\n    var intentCheck = new Discord.Intents(DBM.Bot.intents()).toArray();\n    requiredIntents.forEach(intent => {\n        if (!intentCheck.includes(intent)) {\n            console.log(`[Role Reaction] You don't have the ${intent} intent enabled!`)\n        }\n    })\n\n    if (checkUpdates) {\n        request('https://raw.githubusercontent.com/ItzPike/DBM-Rawdata-Releases/master/Role%20Reaction%20Menu/versionCheck.json', function(error, response, body) {\n            if (response.statusCode == 200) {\n                var allVersions = JSON.parse(body);\n\n                var commandVersions = {};\n                var eventVersions = {};\n                var commandKeys = [];\n                var eventKeys = [];\n\n                allVersions[\"commands\"].forEach(commandVer => {\n                    commandVersions[commandVer[0]] = commandVer[1];\n                    commandKeys.push(commandVer[0]);\n                });\n\n                allVersions[\"events\"].forEach(eventVer => {\n                    eventVersions[eventVer[0]] = eventVer[1];\n                    eventKeys.push(eventVer[0])\n                })\n\n                fs.readFile(\"./data/commands.json\", async function(err, data) {\n                    var data = JSON.parse(data);\n\n                    var systemCommands = await data.filter(command => command != null && commandKeys.includes(command[\"_id\"]));\n\n                    for (i = 0; i < systemCommands.length; i++) {\n                        var systemActionFind = await systemCommands[i][\"actions\"].filter(actionInfo => actionInfo.name = \"Run Script\" && actionInfo.code != null);\n\n                        if (systemActionFind.length != 0) {\n                            var versionCheckSplit = systemActionFind[0].code.split(\"VersionCheck:\");\n                            if (versionCheckSplit[1] != null && versionCheckSplit[1] != commandVersions[systemCommands[i][\"_id\"]] && !isNaN(versionCheckSplit[versionCheckSplit.length - 1])) {\n                                console.log(`[Role Reaction] The command ${systemCommands[i][\"name\"]} needs an update!`)\n                            }\n                        }\n                    }\n                })\n\n                fs.readFile(\"./data/events.json\", async function(err, data) {\n                    var data = JSON.parse(data);\n\n                    var systemEvent = await data.filter(event => event != null && eventKeys.includes(event[\"_id\"]));\n\n                    for (i = 0; i < systemEvent.length; i++) {\n                        var systemEventFind = await systemEvent[i][\"actions\"].filter(actionInfo => actionInfo.name = \"Run Script\" && actionInfo.code != null);\n\n                        if (systemEventFind.length != 0) {\n                            var versionCheckSplit = systemEventFind[0].code.split(\"VersionCheck:\");\n                            if (versionCheckSplit != null && versionCheckSplit[versionCheckSplit.length - 1] != eventVersions[systemEvent[i][\"_id\"]] && !isNaN(versionCheckSplit[versionCheckSplit.length - 1])) {\n                                console.log(`[Role Reaction] The event ${systemEvent[i][\"name\"]} needs an update!`)\n                            }\n                        }\n                    }\n                })\n            }\n        });\n    }\n\n    /*\n    if (globalVars(\"reactionRoleMoved\") == null) {\n        Files.saveGlobalVariable(\"reactionRoleMoved\", true);\n\n        var dataPath = path.normalize(\"./data/roleReaciton\")\n\n        if (!fs.existsSync(`./data/roleReaciton`)) {\n            fs.mkdirSync(`./data/roleReaciton`);\n        }\n\n        [\"reactionRoleData\"].forEach(fileName => {\n            if (fs.existsSync(`./data/${fileName}.json`)) {\n                fs.renameSync( `./data/${fileName}.json`, `./data/roleReaciton/${fileName}.json`);\n            }\n        });\n    }\n    */\n\n    var dataFolder = path.normalize(\"./data/roleReaciton\");\n    var dataFile = path.normalize(\"./data/roleReaciton/reactionRoleData.json\");\n\n    if (!fs.existsSync(dataFolder)) {\n        fs.mkdirSync(dataFolder);\n    }\n\n    if (fs.existsSync(dataFile)) {\n        fs.readFile(dataFile, function read(err, data) {\n            if (err) {\n                throw err;\n            }\n            data = JSON.parse(data)\n\n            Actions.storeValue(data, 3, 'reactionRoleInf', cache);\n        });\n    } else {\n        fs.writeFile(dataFile, \"{}\", function(err) {\n            if (err) {\n                return console.log(err);\n            }\n        });\n        Actions.storeValue({}, 3, 'reactionRoleInf', cache);\n    }\n\n    client.on('messageReactionAdd', async function(reaction, user) {\n        user = await user;\n\n        if (user == null) {\n            console.log(\"Role reaction error: User is not defined! Please make sure you have followed the new setup for intents to allow this command to work!\");\n        } else {\n            if (!user.bot && reaction != null) {\n                const reactionData = globalVars(\"reactionRoleInf\");\n                const reactionGuild = reaction.message.guild;\n                const reactionMessage = reaction.message;\n                if (reactionData.hasOwnProperty(reactionMessage.id)) {\n                    var emojiName = reaction.emoji.name;\n                    var roleInData = await reactionData[reactionMessage.id].filter(re => re[0] == emojiName || re[0].name == emojiName)\n                    if (roleInData.length != 0) {\n                        var guilduser = await reactionGuild.members.cache.get(user.id);\n                        var roleData = roleInData[0][1];\n\n                        if (!guilduser.roles.cache.has(roleData)) {\n                            var reactionRole = await reactionGuild.roles.cache.get(roleData);\n\n                            guilduser.roles.add(reactionRole)\n                                .catch(function(error) {\n                                    guilduser.send(\"Sorry! I couldn't add the role due to either permission issues or the role's position may be higher than my highest role's position. Please contact an adminstrator about this issue.\")\n                                        .catch(function(error) {\n                                            if (error != \"DiscordAPIError: Cannot send messages to this user\" && debug) {\n                                                console.log(error);\n                                            } else if (debug) {\n                                                console.log(`Unable to send user a message || ${guilduser.name}`)\n                                            }\n                                        });\n                                    if (debug) {\n                                        console.log(error);\n                                    }\n                                });\n\n\n                            if (dmUserAfter) {\n                                guilduser.send(messageSentAdd.replace(\"{rolename}\", `**${reactionRole.name}**`).replace(\"{server}\", `**${reactionGuild.name}**`))\n                                    .catch(function(error) {\n                                        if (error != \"DiscordAPIError: Cannot send messages to this user\" && debug) {\n                                            console.log(error);\n                                        } else if (debug) {\n                                            console.log(`Unable to send user a message || ${guilduser.name}`)\n                                        }\n                                    });\n                            }\n\n                        }\n                    }\n                }\n            }\n        }\n\n    });\n\n    client.on('messageReactionRemove', async function(reaction, user) {\n        user = await user;\n\n        if (user == null) {\n            console.log(\"Role reaction error: User is not defined! Please make sure you have followed the new setup for intents to allow this command to work!\");\n        } else {\n            if (!user.bot) {\n                const reactionData = globalVars(\"reactionRoleInf\");\n                const reactionGuild = reaction.message.guild\n                const reactionMessage = reaction.message;\n                if (reactionData.hasOwnProperty(reactionMessage.id)) {\n                    var emojiName = reaction.emoji.name;\n                    var roleInData = await reactionData[reactionMessage.id].filter(re => re[0] == emojiName || re[0].name == emojiName)\n                    if (roleInData.length != 0) {\n                        var guilduser = await reactionGuild.members.cache.get(user.id);\n                        var roleData = roleInData[0][1];\n\n                        if (guilduser.roles.cache.has(roleData)) {\n                            var reactionRole;\n                            reactionRole = await reactionGuild.roles.cache.get(roleData);\n\n                            guilduser.roles.remove(reactionRole)\n                                .catch(function(error) {\n                                    guilduser.send(\"Sorry! I couldn't remove the role due to either permission issues or the role's position may be higher than my highest role's position. Please contact an adminstrator about this issue.\")\n                                        .catch(function(error) {\n                                            if (error != \"DiscordAPIError: Cannot send messages to this user\" && debug) {\n                                                console.log(error);\n                                            } else if (debug) {\n                                                console.log(`Unable to send user a message || ${guilduser.name}`)\n                                            }\n                                        });\n                                    if (debug) {\n                                        console.log(error);\n                                    }\n                                });\n\n                            if (dmUserAfter) {\n                                guilduser.send(messageSentRemove.replace(\"{rolename}\", `**${reactionRole.name}**`).replace(\"{server}\", `**${reactionGuild.name}**`))\n                                    .catch(function(error) {\n                                        if (error != \"DiscordAPIError: Cannot send messages to this user\" && debug) {\n                                            console.log(error);\n                                        } else if (debug) {\n                                            console.log(`Unable to send user a message || ${guilduser.name}`)\n                                        }\n                                    });\n                            }\n                        }\n                    }\n                }\n            }\n        }\n    });\n\n    client.on('messageDelete', async function(message) {\n        const reactionData = globalVars(\"reactionRoleInf\");\n\n        if(reactionData.hasOwnProperty(message.id)) {\n            delete reactionData[message.id]\n            Actions.storeValue(reactionData, 3, \"reactionRoleInf\", cache);\n            steno.writeFile(dataFile, JSON.stringify(reactionData), function(err) {\n                if (err) {\n                    return console.log(err);\n                }\n            });\n        }\n    })\n}\n\n// VersionCheck:8","storage":"0","varName":"","name":"Run Script"}]},{"name":"<center>Laboratoire","permissions":"NONE","restriction":"1","_id":"ViQIT","actions":[],"event-type":"3"}]